"use strict";(self["webpackChunkai_bot"]=self["webpackChunkai_bot"]||[]).push([[421],{3421:function(t,s,e){e.r(s),e.d(s,{default:function(){return d}});var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"right"},[s("el-scrollbar",{attrs:{height:"400px"}},t._l(t.messages,(function(a,n){return s("div",{key:a.id,staticClass:"allReply"},[a.deleted||null==a.textSystem?t._e():s("div",{staticClass:"chat"},[t.isGptShow?s("img",{staticClass:"chatgptLogo",attrs:{src:e(7731),alt:"GPT Logo"}}):t._e(),s("div",{staticClass:"chat-messages"},[s("div",{staticClass:"message"},[s("div",{staticClass:"content",domProps:{innerHTML:t._s(a.textSystem)}}),s("div",{staticClass:"date"},[t._v(" "+t._s(t.formatTimestamp(a.timestamp))+" ")]),s("div",{staticClass:"delate",on:{click:function(s){return t.delateMsg(n)}}},[s("i",{staticClass:"el-icon-delete"}),s("div",{staticClass:"text"},[t._v("删除")])]),s("div",{staticClass:"copy",on:{click:function(s){return t.copyMsg(n)}}},[s("i",{staticClass:"el-icon-copy-document"}),s("div",{staticClass:"text"},[t._v("复制")])])]),n==t.messages.length-1?s("div",{staticClass:"question-buttons"},t._l(t.questions,(function(e,a){return s("button",{key:a,staticClass:"button-basic question-button",on:{click:function(s){return t.sendQuestion(e)}}},[t._v(" "+t._s(e)+" ")])})),0):t._e()])]),a.deleted2||null==a.text?t._e():s("div",{staticClass:"chat2"},[s("div",{staticClass:"chat-messages2"},[s("div",{staticClass:"message"},[s("div",{staticClass:"content",domProps:{innerHTML:t._s(a.text)}}),s("div",{staticClass:"date"},[t._v(" "+t._s(t.formatTimestamp(a.timestamp))+" ")]),s("div",{staticClass:"delate2",on:{click:function(s){return t.delateMsg(n)}}},[s("div",{staticClass:"text"},[t._v("删除")]),s("i",{staticClass:"el-icon-delete"})]),s("div",{staticClass:"copy2",on:{click:function(s){return t.copyMsg(n)}}},[s("div",{staticClass:"text"},[t._v("复制")]),s("i",{staticClass:"el-icon-copy-document"})])])])])])})),0),s("div",{staticClass:"chat-input"},[s("el-input",{style:{maxHeight:"100px",overflowY:"auto"},attrs:{placeholder:t.hint,disabled:t.control,type:"textarea",rows:3,autosize:""},nativeOn:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.sendMessage.apply(null,arguments)}},model:{value:t.input,callback:function(s){t.input=s},expression:"input"}}),s("div",{staticClass:"clear",on:{click:t.clearInput}},[s("i",{staticClass:"el-icon-brush"}),s("div",{staticClass:"text",staticStyle:{color:"#007bff"}},[t._v("清空输入")])]),s("el-button",{staticClass:"button",attrs:{type:"primary"},on:{click:t.sendMessage}},[t._v("发送")])],1)],1)},n=[],i=(e(4114),e(9143)),o=e(4373),c={data(){return{messages:[],input:"",isGptShow:!1,control:!1,hint:"试着输入点什么...",answer:[],answer1:"",questions:[]}},methods:{async sendPostRequest(){const t="https://api.coze.cn/open_api/v2/chat",s={Authorization:"Bearer pat_8HZ78oW8sUSkyJCX8Aw4YHcNKwNWpNZtxIoeXz272SYd34mmeyWTd7VVtmUtJxYk",Accept:"*/*",Host:"api.coze.cn",Connection:"keep-alive","Content-Type":"application/json"};var e={conversation_id:"123",bot_id:"7386934273737277455",user:"7377559287574298634",query:this.input,stream:!1};try{this.input="";const c=await o.A.post(t,e,{headers:s});console.log(c.data.messages),this.answer1="",this.answer=[];for(var a=0,n=0;n<c.data.messages.length;n++)"answer"==c.data.messages[n].type&&(this.answer[a++]=c.data.messages[n].content.replace(/\n/g,"<br>"),this.answer1+=c.data.messages[n].content.replace(/\n/g,"<br>"));var i=[];for(n=0;n<c.data.messages.length;n++)"follow_up"==c.data.messages[n].type&&i.push(c.data.messages[n].content);this.questions=i,console.log(this.answer);const l={id:Date.now(),text:null,textSystem:this.answer1,timestamp:new Date};this.messages.push(l),this.$nextTick((()=>{const t=document.getElementsByClassName("message"),s=t[t.length-1];s.scrollIntoView({behavior:"smooth",block:"end"}),this.control=!1,this.hint="试着输入点什么..."}))}catch(c){console.error("Error:",c),this.responseData="Error occurred. Check the console for details."}},sendMessage(){this.isGptShow=!0;var t=this.input;this.sendPostRequest();const s={id:Date.now(),text:t,textSystem:null,timestamp:new Date};this.messages.push(s),this.$nextTick((()=>{const t=document.getElementsByClassName("message"),s=t[t.length-1];s.scrollIntoView({behavior:"smooth",block:"end"})})),this.control=!0,this.hint="请耐心等待结果"},processJsonData(t){try{const s=JSON.parse(t);return s}catch(s){return"输入的不是有效的 JSON 数据"}},sendQuestion(t){this.input=t,this.sendMessage()},clearInput(){this.input=""},formatTimestamp(t){return new Intl.DateTimeFormat("default",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}).format(t)},copyMsg(t){try{let s;s=this.messages[t].deleted2||this.messages[t].deleted?"":this.messages[t].text||this.messages[t].textSystem;const e=document.createElement("textarea");e.value=s,e.style.position="fixed",document.body.appendChild(e),e.select();const a=document.execCommand("copy");document.body.removeChild(e),a?(0,i.Message)({type:"success",message:"复制成功"}):(0,i.Message)({type:"error",message:"复制失败，请手动复制"})}catch(s){console.error("复制出错:",s),(0,i.Message)({type:"error",message:"复制出错，请手动复制"})}},delateMsg(t){i.MessageBox.confirm("是否删除此数据吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.messages.splice(t,1),(0,i.Message)({type:"success",message:"删除成功"})})).catch((()=>{}))}}},l=c,r=e(1656),u=(0,r.A)(l,a,n,!1,null,"40ae0e53",null),d=u.exports},7731:function(t,s,e){t.exports=e.p+"img/gpt.5b8b8889.png"}}]);
//# sourceMappingURL=421.96be1c54.js.map